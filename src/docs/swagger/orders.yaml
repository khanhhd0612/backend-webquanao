/order:
  post:
    tags:
      - Orders
    summary: Tạo đơn hàng
    description: Tạo đơn hàng mới từ giỏ hàng
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/CreateOrderRequest'
    responses:
      '201':
        description: Tạo đơn hàng thành công
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Order'
      '400':
        $ref: '#/components/responses/ValidationError'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '404':
        $ref: '#/components/responses/NotFoundError'

  get:
    tags:
      - Orders
    summary: Lấy danh sách đơn hàng
    description: Lấy tất cả đơn hàng (chỉ Admin)
    security:
      - bearerAuth: []
    parameters:
      - in: query
        name: userId
        schema:
          type: string
        description: Lọc theo ID người dùng
      - in: query
        name: paymentMethod
        schema:
          type: string
          enum: [COD, VNPay]
        description: Lọc theo phương thức thanh toán
      - in: query
        name: paymentStatus
        schema:
          type: string
          enum: [pending, paid, failed]
        description: Lọc theo trạng thái thanh toán
      - in: query
        name: orderStatus
        schema:
          type: string
          enum: [pending, confirmed, shipped, delivered, cancelled]
        description: Lọc theo trạng thái đơn hàng
      - in: query
        name: page
        schema:
          type: integer
          minimum: 1
          default: 1
        description: Số trang
      - in: query
        name: limit
        schema:
          type: integer
          minimum: 1
          default: 10
        description: Số lượng mỗi trang
      - in: query
        name: sortBy
        schema:
          type: string
          example: "createdAt:desc"
        description: Sắp xếp theo trường
    responses:
      '200':
        description: Lấy danh sách thành công
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/PaginationResponse'
                - type: object
                  properties:
                    results:
                      type: array
                      items:
                        $ref: '#/components/schemas/Order'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '403':
        $ref: '#/components/responses/ForbiddenError'

/order/{orderId}:
  get:
    tags:
      - Orders
    summary: Lấy chi tiết đơn hàng
    description: Lấy thông tin chi tiết một đơn hàng (chỉ Admin)
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: orderId
        required: true
        schema:
          type: string
        description: ID của đơn hàng
    responses:
      '200':
        description: Lấy thông tin thành công
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Order'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '403':
        $ref: '#/components/responses/ForbiddenError'
      '404':
        $ref: '#/components/responses/NotFoundError'

/order/user/get:
  get:
    tags:
      - Orders
    summary: Lấy đơn hàng của người dùng
    description: Lấy tất cả đơn hàng của người dùng hiện tại
    security:
      - bearerAuth: []
    responses:
      '200':
        description: Lấy danh sách thành công
        content:
          application/json:
            schema:
              oneOf:
                - type: object
                  properties:
                    message:
                      type: string
                      example: "Bạn chưa có đơn hàng nào"
                - type: array
                  items:
                    $ref: '#/components/schemas/Order'
      '401':
        $ref: '#/components/responses/UnauthorizedError'

/order/{orderId}/status:
  patch:
    tags:
      - Orders
    summary: Cập nhật trạng thái đơn hàng
    description: Cập nhật trạng thái đơn hàng và thanh toán (chỉ Admin)
    security:
      - bearerAuth: []
    parameters:
      - in: path
        name: orderId
        required: true
        schema:
          type: string
        description: ID của đơn hàng
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/UpdateOrderStatusRequest'
    responses:
      '200':
        description: Cập nhật thành công
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Order'
      '401':
        $ref: '#/components/responses/UnauthorizedError'
      '403':
        $ref: '#/components/responses/ForbiddenError'
      '404':
        $ref: '#/components/responses/NotFoundError'